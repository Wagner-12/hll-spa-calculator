<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>SPA Calculator Hell Let Loose - Artiller√≠a Autopropulsada / Mobile Artillery</title>
    <meta name="description" content="Calculadora precisa para Artiller√≠a M√≥vil (SPA) en Hell Let Loose. Compatible: US, GER, RUS. Rango 200m - 600m. Tactical HUD.">
    <meta name="keywords" content="Hell Let Loose, SPA, Artilleria, Artillery, Calculator, Calculadora, Hummel, Greyhound, Mobile Artillery, Tactical">
    <meta name="author" content="wagner12">
    <meta name="google-site-verification" content="4PNZYE7dD4Iua1q1CoIkI6fEwGAu9thmWaMejlCspTs" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.0.2/css/flag-icons.min.css"/>
    
    <style>
        :root {
            --bg-color: #0f0f0f;
            --card-bg: #1a1a1a;
            --text-color: #e0e0e0;
            --hll-orange: #ff9800;
            --danger: #ff4444;
            --success: #66bb6a;
            --warning: #ffd700;
            --lang-bg: #111;
            --history-bg: #151515;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
            flex-direction: column;
            
            /* FONDO T√ÅCTICO (GRID) */
            background-image: 
                linear-gradient(rgba(15, 15, 15, 0.92), rgba(15, 15, 15, 0.92)),
                linear-gradient(0deg, #333 1px, transparent 1px),
                linear-gradient(90deg, #333 1px, transparent 1px);
            background-size: 100% 100%, 40px 40px, 40px 40px;
        }

        /* EFECTO MONITOR (SCANLINES) */
        .scanline-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.1) 50%,
                rgba(0,0,0,0.1)
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 999;
        }

        .container {
            background-color: var(--card-bg);
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.95);
            width: 100%;
            max-width: 360px;
            text-align: center;
            border: 1px solid #333;
            position: relative;
            z-index: 10;
        }

        /* BANDERAS */
        .lang-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            padding: 12px;
            background-color: var(--lang-bg);
            border-radius: 12px;
            border: 1px solid #333;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
        }
        
        .lang-btn {
            background: transparent;
            border: 2px solid #444;
            border-radius: 50%;
            width: 42px; height: 42px;
            cursor: pointer; padding: 0; overflow: hidden;
            transition: all 0.3s ease;
        }
        .lang-btn .fi { width: 100%; height: 100%; object-fit: cover; font-size: 42px; line-height: 42px; }
        .lang-btn:not(.active) { filter: grayscale(100%); opacity: 0.4; }
        .lang-btn:hover { filter: grayscale(0%); opacity: 1; transform: scale(1.1); border-color: #888; }
        .lang-btn.active { 
            filter: grayscale(0%); opacity: 1; 
            border-color: var(--hll-orange); 
            box-shadow: 0 0 15px rgba(255, 152, 0, 0.4); 
            transform: scale(1.05); 
        }

        /* TIPOGRAF√çA Y DISE√ëO */
        h1 { margin: 0 0 5px 0; font-size: 1.5rem; text-transform: uppercase; color: #fff; letter-spacing: 2px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .subtitle { font-size: 0.9rem; color: #888; margin-bottom: 5px; font-weight: bold; }
        
        .compatibility-note { 
            font-size: 0.75rem; color: #666; margin-bottom: 25px; 
            font-style: italic; border-bottom: 1px solid #333; padding-bottom: 15px; 
        }
        .compatibility-note span { color: var(--danger); font-weight: bold; }

        .input-group { margin-bottom: 15px; display: flex; flex-direction: column; }
        label { display: block; margin-bottom: 5px; font-size: 0.75rem; color: #aaa; text-transform: uppercase; letter-spacing: 1px; text-align: left; }
        .input-container { display: flex; width: 100%; }

        /* INPUTS ESTILO DIGITAL */
        input[type="number"] {
            flex-grow: 1; padding: 12px; font-size: 1.8rem;
            border-radius: 8px; border: 2px solid #333;
            background-color: #0d0d0d; color: #fff; text-align: center;
            font-family: 'Share Tech Mono', monospace; /* Fuente Digital */
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.2);
            -moz-appearance: textfield;
            transition: border-color 0.3s;
        }
        input:focus { border-color: var(--hll-orange); outline: none; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

        /* BOTONES DE AJUSTE */
        .adj-buttons { display: flex; gap: 5px; justify-content: center; margin-top: 5px; }
        .adj-btn { 
            background: #252525; border: 1px solid #333; color: #ccc; 
            padding: 10px; border-radius: 4px; cursor: pointer; 
            font-family: 'Share Tech Mono', monospace; font-size: 1rem;
            transition: all 0.2s; flex: 1; 
        }
        .adj-btn:active { transform: scale(0.95); background: #333; }
        .adj-btn.pos { color: var(--success); border-bottom: 2px solid rgba(102, 187, 106, 0.3); }
        .adj-btn.neg { color: var(--danger); border-bottom: 2px solid rgba(255, 68, 68, 0.3); }

        .mic-btn { padding: 0 15px; background-color: #222; color: #666; border: 2px solid #333; border-left: none; border-radius: 0 8px 8px 0; cursor: pointer; font-size: 1.3rem; transition: all 0.3s; }
        .mic-btn.listening { background-color: var(--danger); color: white; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(255, 68, 68, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0); } }

        /* RESULTADOS DIGITALES */
        .result-box { 
            background: linear-gradient(180deg, #1f1f1f, #151515); 
            padding: 20px; border-radius: 12px; border: 1px solid #333; 
            margin-top: 25px; margin-bottom: 10px; 
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
            cursor: pointer; /* Indicar clicable */
            transition: transform 0.1s;
            position: relative;
        }
        .result-box:active { transform: scale(0.98); }
        .result-box:hover .copy-hint { opacity: 1; }
        
        .result-title { font-size: 0.8rem; text-transform: uppercase; color: #555; margin-bottom: 5px; letter-spacing: 1px; }
        
        .result-value { 
            font-family: 'Share Tech Mono', monospace; /* Fuente Digital */
            font-size: 4rem; 
            color: var(--hll-orange); 
            line-height: 1; 
            text-shadow: 0 0 15px rgba(255, 152, 0, 0.6); /* Efecto Ne√≥n */
        }

        .copy-hint {
            position: absolute; top: 10px; right: 10px;
            font-size: 0.7rem; color: #555;
            opacity: 0; transition: opacity 0.3s;
            font-family: 'Segoe UI', sans-serif;
            text-transform: uppercase;
        }
        
        .info-text { 
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.9rem; color: #666; min-height: 1.2em; margin-top: 5px;
        }
        
        .warning-note { 
            font-size: 0.75rem; color: var(--warning); margin-top: 10px; 
            background: rgba(255, 215, 0, 0.05); padding: 10px; border-radius: 6px; 
            border: 1px solid rgba(255, 215, 0, 0.15); text-align: left; 
        }
        .warning-note b { display: block; margin-bottom: 3px; color: #fff; }

        /* HISTORIAL */
        .history-container {
            margin-top: 20px;
            border-top: 1px solid #333;
            padding-top: 15px;
        }
        .history-title {
            font-size: 0.75rem; color: #555; text-transform: uppercase; margin-bottom: 10px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .clear-btn {
            background: none; border: 1px solid #333; color: #555; 
            cursor: pointer; font-size: 0.7rem; padding: 2px 8px; border-radius: 4px;
        }
        .clear-btn:hover { background: #222; color: #aaa; }
        
        .history-list {
            display: flex; flex-direction: column; gap: 8px;
        }
        .history-item {
            background: var(--history-bg);
            padding: 8px 12px;
            border-radius: 6px;
            display: flex; justify-content: space-between; align-items: center;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.9rem;
            border-left: 2px solid #333;
            animation: fadeIn 0.3s ease-in-out;
        }
        .history-item span.h-dist { color: #888; }
        .history-item span.h-mils { color: var(--hll-orange); font-weight: bold; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* FOOTER SEO */
        .seo-footer { margin-top: 40px; font-size: 0.7rem; color: #444; text-align: center; border-top: 1px solid #222; padding-top: 15px; width: 100%; max-width: 360px;}
        .keywords-small { color: #333; font-size: 0.6rem; }
        
        /* Toast Notification */
        .toast {
            position: absolute; bottom: 80px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); color: white; padding: 8px 16px; border-radius: 20px;
            font-size: 0.8rem; pointer-events: none; opacity: 0; transition: opacity 0.3s;
            border: 1px solid var(--hll-orange);
        }
        .toast.show { opacity: 1; }

    </style>
</head>
<body>

<div class="scanline-overlay"></div>

<div class="container">
    
    <div class="lang-selector">
        <button class="lang-btn active" onclick="setLang('es')" title="Espa√±ol"><span class="fi fi-es"></span></button>
        <button class="lang-btn" onclick="setLang('en')" title="English"><span class="fi fi-us"></span></button>
        <button class="lang-btn" onclick="setLang('de')" title="Deutsch"><span class="fi fi-de"></span></button>
        <button class="lang-btn" onclick="setLang('pt')" title="Portugu√™s"><span class="fi fi-br"></span></button>
        <button class="lang-btn" onclick="setLang('ru')" title="–†—É—Å—Å–∫–∏–π"><span class="fi fi-ru"></span></button>
    </div>

    <h1>SPA Calc (600M)</h1>
    
    <div class="subtitle" id="t-subtitle">Compatible: URSS / USA / GER</div>
    <div class="compatibility-note" id="t-note">
        ‚ö†Ô∏è Nota: <span>GB (Brit√°nicos)</span> a√∫n en fase de pruebas.<br>No usar para esa facci√≥n.
    </div>

    <div class="input-group">
        <label id="t-dist-label">Distancia (Metros)</label>
        <div class="input-container">
            <input type="number" id="distance" placeholder="0" oninput="calculate()">
            <button class="mic-btn" id="micBtn" onclick="toggleVoice()">üéôÔ∏è</button>
        </div>
    </div>

    <div class="input-group">
        <label id="t-adj-label">Correcci√≥n Invertida (+/- Mils)</label>
        <div class="input-container">
            <input type="number" id="adjustment" placeholder="0" oninput="calculate()">
        </div>
        <div class="adj-buttons">
            <button class="adj-btn neg" onclick="quickAdjust(-10)">-10</button>
            <button class="adj-btn neg" onclick="quickAdjust(-5)">-5</button>
            <button class="adj-btn pos" onclick="quickAdjust(5)">+5</button>
            <button class="adj-btn pos" onclick="quickAdjust(10)">+10</button>
        </div>
        <div class="warning-note" id="t-warning">
            ‚ö†Ô∏è <b>L√≥gica Invertida:</b><br>
            ‚Ä¢ Positivos (+) se RESTAN.<br>
            ‚Ä¢ Negativos (-) se SUMAN.
        </div>
    </div>

    <!-- RESULTADO CLICABLE -->
    <div class="result-box" id="result-box" onclick="copyToClipboard()" title="Click to Copy">
        <div class="copy-hint">COPIAR</div>
        <div class="result-title" id="t-res-title">Elevaci√≥n Final</div>
        <div class="result-value" id="mils">--</div>
    </div>

    <div class="info-text" id="info-display">ESPERANDO DATOS...</div>

    <!-- SECCI√ìN HISTORIAL -->
    <div class="history-container">
        <div class="history-title">
            <span id="t-hist-title">Historial Reciente</span>
            <button class="clear-btn" onclick="clearHistory()" id="t-clear">Limpiar</button>
        </div>
        <div class="history-list" id="history-list">
            <!-- Items generados din√°micamente -->
        </div>
    </div>
    
    <div class="toast" id="toast">Copiado!</div>
</div>

<div class="seo-footer">
    <p>Hell Let Loose SPA Calculator (Mobile Artillery) | Calculadora de Artiller√≠a Autopropulsada</p>
    <p class="keywords-small">
        tags: Selbstfahrlafette Rechner (Deutsch), Calculadora de Artilharia M√≥vel (Portugu√™s), 
        –ú–æ–±–∏–ª—å–Ω–∞—è –∞—Ä—Ç–∏–ª–ª–µ—Ä–∏—è (–†—É—Å—Å–∫–∏–π), HLL Artillery Tool, Hummel, Greyhound.
    </p>
</div>

<script>
    // --- VARIABLES DE CONFIGURACI√ìN ---
    const MIN_RANGE = 200; // Zona Muerta
    const MAX_RANGE = 600; // Rango M√°ximo
    const STD_BASE = 666;
    const STD_SLOPE = 0.665;
    
    let currentLang = 'es';
    let history = [];

    const translations = {
        es: { 
            subtitle: "Compatible: URSS / USA / GER", note: "‚ö†Ô∏è Nota: <span>GB (Brit√°nicos)</span> a√∫n en fase de pruebas.<br>No usar para esa facci√≥n.", distLabel: "Distancia (Metros)", adjLabel: "Correcci√≥n Invertida (+/- Mils)", warning: "‚ö†Ô∏è <b>L√≥gica Invertida:</b><br>‚Ä¢ Positivos (+) se RESTAN.<br>‚Ä¢ Negativos (-) se SUMAN.", resTitle: "Elevaci√≥n Final", waiting: "ESPERANDO DATOS...", outRange: "FUERA DE RANGO", max: "MAX 600", min: "MIN 200", noCorrection: "SIN CORRECCI√ìN", base: "Base", applying: "Aplicando", voiceLang: "es-ES", voiceError: "Voz no soportada",
            histTitle: "Historial Reciente", clear: "Limpiar", copied: "Copiado!"
        },
        en: { 
            subtitle: "Compatible: USSR / USA / GER", note: "‚ö†Ô∏è Note: <span>GB (British)</span> still in testing.<br>Do not use for this faction.", distLabel: "Distance (Meters)", adjLabel: "Inverted Correction (+/- Mils)", warning: "‚ö†Ô∏è <b>Inverted Logic:</b><br>‚Ä¢ Positives (+) SUBTRACT.<br>‚Ä¢ Negatives (-) ADD.", resTitle: "Final Elevation", waiting: "WAITING DATA...", outRange: "OUT OF RANGE", max: "MAX 600", min: "MIN 200", noCorrection: "NO CORRECTION", base: "Base", applying: "Applying", voiceLang: "en-US", voiceError: "Voice not supported",
            histTitle: "Recent History", clear: "Clear", copied: "Copied!"
        },
        de: { 
            subtitle: "Kompatibel: UdSSR / USA / DEU", note: "‚ö†Ô∏è Hinweis: <span>GB (Briten)</span> noch im Test.<br>Nicht f√ºr diese Fraktion verwenden.", distLabel: "Entfernung (Meter)", adjLabel: "Umgekehrte Korrektur (+/- Mils)", warning: "‚ö†Ô∏è <b>Umgekehrte Logik:</b><br>‚Ä¢ Positive (+) werden ABGEZOGEN.<br>‚Ä¢ Negative (-) werden ADDIERT.", resTitle: "Endg√ºltige Erh√∂hung", waiting: "WARTE AUF DATEN...", outRange: "AUSSER REICHWEITE", max: "MAX 600", min: "MIN 200", noCorrection: "KEINE KORREKTUR", base: "Basis", applying: "Anwenden", voiceLang: "de-DE", voiceError: "Spracheingabe nicht unterst√ºtzt",
            histTitle: "Verlauf", clear: "L√∂schen", copied: "Kopiert!"
        },
        pt: { 
            subtitle: "Compat√≠vel: URSS / EUA / ALE", note: "‚ö†Ô∏è Nota: <span>GB (Brit√¢nicos)</span> ainda em testes.<br>N√£o usar para essa fac√ß√£o.", distLabel: "Dist√¢ncia (Metros)", adjLabel: "Corre√ß√£o Invertida (+/- Mils)", warning: "‚ö†Ô∏è <b>L√≥gica Invertida:</b><br>‚Ä¢ Positivos (+) SUBTRAEM.<br>‚Ä¢ Negativos (-) SOMAM.", resTitle: "Eleva√ß√£o Final", waiting: "AGUARDANDO DADOS...", outRange: "FORA DE ALCANCE", max: "M√ÅX 600", min: "M√çN 200", noCorrection: "SEM CORRE√á√ÉO", base: "Base", applying: "Aplicando", voiceLang: "pt-BR", voiceError: "Voz n√£o suportada",
            histTitle: "Hist√≥rico Recente", clear: "Limpar", copied: "Copiado!"
        },
        ru: { 
            subtitle: "–°–æ–≤–º–µ—Å—Ç–∏–º–æ: –°–°–°–† / –°–®–ê / –ì–ï–†", note: "‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: <span>–ë—Ä–∏—Ç–∞–Ω–∏—è (GB)</span> –≤ —Ç–µ—Å—Ç–µ.<br>–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —ç—Ç–æ–π —Ñ—Ä–∞–∫—Ü–∏–∏.", distLabel: "–î–∏—Å—Ç–∞–Ω—Ü–∏—è (–ú–µ—Ç—Ä—ã)", adjLabel: "–û–±—Ä–∞—Ç–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è (+/- –ú–∏–ª)", warning: "‚ö†Ô∏è <b>–û–±—Ä–∞—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞:</b><br>‚Ä¢ –ü–ª—é—Å (+) –í–´–ß–ò–¢–ê–¢–¨.<br>‚Ä¢ –ú–∏–Ω—É—Å (-) –ü–†–ò–ë–ê–í–õ–Ø–¢–¨.", resTitle: "–ò—Ç–æ–≥–æ–≤—ã–π –£–≥–æ–ª", waiting: "–û–ñ–ò–î–ê–ù–ò–ï –î–ê–ù–ù–´–•...", outRange: "–í–ù–ï –î–ò–°–¢–ê–ù–¶–ò–ò", max: "–ú–ê–ö–° 600", min: "–ú–ò–ù 200", noCorrection: "–ë–ï–ó –ü–û–ü–†–ê–í–û–ö", base: "–ë–∞–∑–∞", applying: "–ö–æ—Ä—Ä.", voiceLang: "ru-RU", voiceError: "–ì–æ–ª–æ—Å –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è",
            histTitle: "–ò—Å—Ç–æ—Ä–∏—è", clear: "–û—á–∏—Å—Ç–∏—Ç—å", copied: "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!"
        }
    };

    function setLang(lang) {
        currentLang = lang;
        const t = translations[lang];
        document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
        const activeBtn = event.target.closest('.lang-btn');
        if (activeBtn) activeBtn.classList.add('active');

        document.getElementById('t-subtitle').innerText = t.subtitle;
        document.getElementById('t-note').innerHTML = t.note;
        document.getElementById('t-dist-label').innerText = t.distLabel;
        document.getElementById('t-adj-label').innerText = t.adjLabel;
        document.getElementById('t-warning').innerHTML = t.warning;
        document.getElementById('t-res-title').innerText = t.resTitle;
        document.getElementById('t-hist-title').innerText = t.histTitle;
        document.getElementById('t-clear').innerText = t.clear;
        
        calculate();
    }

    // Debounce para no llenar el historial mientras escribes
    let timeout = null;

    function calculate() {
        const distInput = document.getElementById('distance');
        const adjInput = document.getElementById('adjustment');
        const display = document.getElementById('mils');
        const info = document.getElementById('info-display');
        const t = translations[currentLang];

        if (!distInput || !adjInput) return;
        const distVal = distInput.value;
        const adjVal = adjInput.value;

        if (!distVal) { display.innerText = "--"; info.innerText = t.waiting; return; }
        const dist = parseFloat(distVal);
        const adj = parseFloat(adjVal) || 0;

        // VALIDACI√ìN
        if (dist > MAX_RANGE) { 
            display.innerText = t.max; display.style.color = "#ff4444"; 
            display.style.textShadow = "0 0 10px rgba(255, 68, 68, 0.6)";
            info.innerText = t.outRange; return; 
        }
        if (dist < MIN_RANGE) { 
            display.innerText = t.min; display.style.color = "#ff4444"; 
            display.style.textShadow = "0 0 10px rgba(255, 68, 68, 0.6)";
            info.innerText = t.outRange; return; 
        }

        const baseMils = STD_BASE - (dist * STD_SLOPE);
        let finalMils = baseMils - adj; 
        if (finalMils < 0) finalMils = 0;
        
        const finalRounded = Math.round(finalMils);

        display.innerText = finalRounded;
        display.style.color = "#ff9800";
        display.style.textShadow = "0 0 15px rgba(255, 152, 0, 0.6)"; 

        if (adj !== 0) {
            const operationSign = adj > 0 ? '-' : '+'; 
            info.innerHTML = `${t.base}: ${Math.round(baseMils)} <span style="color:#444">|</span> ${t.applying}: <b style="color:${operationSign === '+' ? '#66bb6a' : '#ff4444'}">${operationSign}${Math.abs(adj)}</b>`;
        } else {
            info.innerText = t.noCorrection;
        }

        // Agregar al historial con retraso (solo cuando el usuario deja de escribir)
        clearTimeout(timeout);
        timeout = setTimeout(() => {
            addToHistory(dist, finalRounded);
        }, 1500);
    }

    function addToHistory(dist, mils) {
        // Evitar duplicados seguidos
        if (history.length > 0 && history[0].dist === dist && history[0].mils === mils) return;

        history.unshift({ dist, mils });
        if (history.length > 3) history.pop(); // Mantener solo √∫ltimos 3
        renderHistory();
    }

    function renderHistory() {
        const list = document.getElementById('history-list');
        list.innerHTML = "";
        history.forEach(item => {
            const div = document.createElement('div');
            div.className = 'history-item';
            div.innerHTML = `<span class="h-dist">${item.dist}m</span> <span class="h-mils">${item.mils}</span>`;
            list.appendChild(div);
        });
    }

    function clearHistory() {
        history = [];
        renderHistory();
    }

    function quickAdjust(val) {
        const adjInput = document.getElementById('adjustment');
        if (!adjInput) return;
        let current = parseFloat(adjInput.value) || 0;
        adjInput.value = current + val;
        calculate(); 
    }

    function copyToClipboard() {
        const mils = document.getElementById('mils').innerText;
        if (mils === "--" || mils.includes("MAX") || mils.includes("MIN")) return;
        
        navigator.clipboard.writeText(mils).then(() => {
            const toast = document.getElementById('toast');
            toast.innerText = translations[currentLang].copied;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        });
    }

    const micBtn = document.getElementById('micBtn');
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    let recognition = null;

    if (SpeechRecognition) {
        recognition = new SpeechRecognition();
        recognition.continuous = false;
        recognition.onstart = function() { micBtn.classList.add('listening'); };
        recognition.onend = function() { micBtn.classList.remove('listening'); };
        recognition.onresult = function(e) {
            const transcript = e.results[0][0].transcript;
            const numberMatch = transcript.match(/\d+/); 
            if (numberMatch) {
                document.getElementById('distance').value = numberMatch[0];
                document.getElementById('adjustment').value = ""; 
                calculate();
            }
        };
    } else { micBtn.style.display = 'none'; }

    function toggleVoice() {
        if (!recognition) { alert(translations[currentLang].voiceError); return; }
        recognition.lang = translations[currentLang].voiceLang;
        recognition.start();
    }
</script>

</body>

</html>

